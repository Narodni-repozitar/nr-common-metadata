# Copyright (c) 2022 CESNET
#
# This software is released under the MIT License.
# https://opensource.org/licenses/MIT

^use: [invenio]

$defs:
  NRAuthorityIdentifier:
    ^ui:
      default:
        component: icon
        dataField: scheme
        iconSet:
          DOI: icons/identifier/doi.gif
          scopusID: icons/identifier/scopus.svg
          orcid: icons/identifier/orcid.png
    properties:
      identifier:
        type: keyword
        required: true
        label.cs: Identifikátor
        label.en: Identifier
        ^sample:
          faker: isbn13
        # UI: tooltip by měl v hotovém záznamu pro všechny typy říkat typ: id, tj. např. "orcid: 13245646331"
      scheme:
        type: keyword
        required: true
        enum:
          [
            orcid,
            scopusID,
            researcherID,
            czenasAutID,
            vedidk,
            institutionalID,
            ISNI,
            ROR,
            ICO,
            DOI,
          ]
          # UI: orcid by se měl zobrazovat (label) jako ORCID iD
        label.cs: Typ identifikátoru
        label.en: Identifier type
        hint.cs: |
          Doporučujeme zadat alespoň jeden z typů identifikátorů.
          Pokud potřebujete rozšířit nabídku typů identifikátorů, kontaktujte nás na support@narodni-repozitar.cz.
        hint.en: |
          We recommend providing at least one of the identifier types.
          If you need to expand the range of identifier types, contact us at support@narodni-repozitar.cz.

  NRAuthority:
    properties:
      fullName:
        # TODO: moznost duplicity - pridat pole jmeno a prijmeni pro nove zaznamy + do ui generovani fullName podle pravidel
        type: keyword
        required: true
        ^sample:
          faker: name
        ^ui:
          component: span
      nameType:
        type: keyword
        enum: [Organizational, Personal]
        ^sample: [Organizational, Personal]
        label.cs: Typ
        label.en: Type
        tooltip.cs: Jako tvůrce je možné označit osobu nebo instituci.
        tooltip.en: It is possible to designate a person or an institution as the creator/contributor.
      authorityIdentifiers[]:
        ^use: '#/$defs/NRAuthorityIdentifier'
        uniqueItems[]: true
        ^ui[]:
          default:
            component: list
            horizontal: true
            separator:
              component: separator
            item:
              # TODO: this reference should be automagically done by model builder
              ^use: '#/$defs/NRAuthorityIdentifier/^ui/default'
      affiliations[]:
        # taxonomie institutions
        ^sample:
          faker: company
        ^vocabulary:
          type: affiliation
          fields: [id, title]
        uniqueItems[]: true
        label.cs: Afiliace
        label.en: Affiliation
        hint.cs: Uveďte instituci/instituce, pod jejíž záštitou jste se na tvorbě objektu podíleli.
        hint.en:

  NRObjectPID:
    # Persistent identifier of object

    properties:
      identifier:
        type: keyword
        required: true
        ^sample:
          faker: isbn13
        ^ui:
          default:
            component: span
        label.cs: Identifikátor objektu
        label.en: Object identifier
      scheme:
        type: keyword
        required: true
        ^ui:
          default:
            component: icon
            dataField: scheme
            iconSet:
              DOI: icons/identifier/doi.gif
        enum: [DOI, Handle, ISBN, ISSN, RIV]
        label.cs: Typ identifikátoru
        label.en: Identifier type

  NRDateOrRange:
    type: keyword
    # TODO: jak validovat a interpretovat tento format (a jak ho pak spravne facetovat)
    format: 'year | yearmonth | date | datetime | year-range | yearmonth-range | date-range | datetime-range'
    ^ui:
      default:
        component: span

  NRDate:
    type: keyword
    ^ui:
      default:
        component: span
    # format: [ year | yearmonth | date | datetime ]

  NRLocation:
    properties:
      place:
        type: keyword
        required: true
        label.cs: Místo
        label.en: Place
      country:
        ^use: '#/$defs/NRCountry'

  NRCountry:
    ^vocabulary:
      type: country
      fields: [id, title]
    label.cs: Země
    label.en: Country

  NRLongitude:
    type: number
    minimum: -180
    maximum: 180
    label.cs: Zeměpisná délka
    label.en: Longitude

  NRLatitude:
    type: number
    minimum: -90
    maximum: 90
    label.cs: Zeměpisná šířka
    label.en: Latitude

  NRAuthorityRole:
    ^ui:
      default:
        component: span
    ^vocabulary:
      type: role
      fields: [id, title]
    label.cs: Role přispěvatele
    label.en: Contributor's role

  NRRelatedItem:
    description: linkdata, propojení přidružených dokumentů a datasetů.
    label.cs: Vazby na/z dalších zdrojů:
    label.en: Link to/from other resources:
    properties:
      itemTitle:
        description: název propojeného dokumentu
        label.cs: Název
        label.en: Title
        type: fulltext
        required: true
        ^ui:
          default:
            component: span

      itemCreators[]:
        ^use: '#/$defs/NRAuthority'
        uniqueItems[]: true
        label.cs: Autoři
        label.en: Authors
        properties:
          affiliations[]:
            ^vocabulary:
              name: item-creator-affiliations
            label.cs: Afiliace
            label.en: Affiliation

      itemContributors[]:
        ^use: '#/$defs/NRAuthority'
        label.cs: Přispěvatelé
        label.en: Contributors
        properties:
          role:
            ^use: '#/$defs/NRAuthorityRole'
          affiliations[]:
            ^vocabulary:
              name: item-creator-affiliations
            label.cs: Afiliace
            label.en: Affiliation
        uniqueItems[]: true

      itemPIDs[]:
        ^use: '#/$defs/NRObjectPID'
        uniqueItems[]: true

      itemURL:
        type: keyword
        format: URL
        ^ui:
          default:
            component: link
        ^sample:
          faker: url
        label.cs: URL
        label.en: URL

      itemYear:
        type: integer
        ^ui:
          default:
            component: span
        label.cs: Rok
        label.en: Year

      itemVolume:
        type: keyword
        ^ui:
          default:
            component: span
        label.cs: Ročník
        label.en: Volume

      itemIssue:
        type: keyword
        ^ui:
          default:
            component: span
        label.cs: Číslo
        label.en: Issue

      itemStartPage:
        type: keyword
        ^ui:
          default:
            component: span
        label.cs: Počáteční strana
        label.en: Start page

      itemEndPage:
        type: keyword
        ^ui:
          default:
            component: span
        label.cs: Poslední strana
        label.en: End page

      itemPublisher:
        type: keyword
        ^ui:
          default:
            component: span
        label.cs: Vydavatel
        label.en: Publisher

      itemRelationType:
        description: typ vztahu k původnímu popisovanému dok.
        ^vocabulary:
          type: itemRelationType
          fields: [id, title]
        label.cs: Typ vazby
        label.en: Relation type

      itemResourceType:
        ^use: '#/$defs/NRResourceType'

  NRResourceType:
    ^vocabulary:
      type: resourceType
      fields: [id, title]
    ^sample: ['Bakalářská práce', 'Diplomová práce', 'Dataset']
    label.cs: Typ zdroje
    label.en: Resource type

  NRFundingReference:
    # informace o přidruženém projektu
    #
    # MIGRACE NUŠL - protože v datech NUŠL hrozný stav v polích pro poskytovatele.
    # u českých projektů na základě prvních dvou znaků v řetězci s identifikátorem
    # projektu lze přiřadit poskytovatele.
    ^ui:
      default:
        component: divided-row
        separator:
          component: separator
        items:
          - component: span
            dataField: projectID
          - component: span
            dataField: projectName
    properties:
      projectID:
        type: keyword
        required: true
        label.cs: Číslo projektu
        label.en: Project number
      projectName:
        type: fulltext
        label.cs: Název projektu
        label.en: Project name
      fundingProgram:
        type: fulltext
        label.cs: Výzkumný program
        label.en: Funding program
      funder:
        ^use: '#/$defs/NRFunder'
        #required: true

  NRSubject:
    properties:
      subjectScheme:
        type: keyword
        ^sample: ['keyword', 'czenas', 'psh']
      subject:
        type: i18nStr
        required: true
        label.cs: Klíčová slova
        label.en: Keywords
      valueURI:
        type: keyword
        ^sample:
          faker: url
      classificationCode:
        type: keyword

  NRSubjectCategory:
    ^vocabulary:
      type: subjectCategories
      fields: [id, title]
    ^sample:
      ['Pravděpodobnost a statistika', 'Matematika', 'Chemické vědy']
    label.cs: Oborové třídění
    label.en: Subject categories

  NRFunder:
    ^vocabulary:
      type: funders
      fields: [id, title]
    label.cs: Poskytovatel financí
    label.en: Funder

  NRGeoLocation:
    properties:
      geoLocationPlace:
        description: Free description of the location; ie. Atlantic Ocean
        type: keyword
        required: true
      geoLocationPoint:
        properties:
          pointLongitude:
            ^use: '#/$defs/NRLongitude'
            required: true
          pointLatitude:
            ^use: '#/$defs/NRLatitude'
            required: true

  NRSystemIdentifier:
    # systémové identifikátory a trvalé adresy pořízené skrze OAI, případně importy/migrace",
    #
    # možná bude sekce OAI fungovat jinak,takže možná bude potřeba to upravit. Ale tohle jsou údaje,
    # které by se měli ukládat přímo v záznamu; nusl = PURL
    properties:
      identifier:
        type: keyword
        required: true
        label.cs: Systémové identifikátory
        label.en: System Identifiers
      scheme:
        type: keyword
        enum: [nusl, nuslOAI, originalRecordOAI, catalogueSysNo, nrOAI]
        required: true
        label.cs: Typ identifikátoru
        label.en: Identifier type

  NREvent:
    properties:
      eventNameOriginal:
        # volný zápis celého názvu akce
        type: fulltext
        required: true
        label.cs: Název akce
        label.en: Event name

      eventNameAlternate[]:
        # zkrácená forma názvu akce nebo překladu. měla by fungovat jako alias pro vyhledávání
        type: fulltext
        label.cs: Alternativní název akce
        label.en: Event alternate name

      eventDate:
        # rozsah konání akce/konference -  date or range.
        ^use: '#/$defs/NRDateOrRange'
        required: true
        label.cs: Datum konání akce
        label.en: Event date

      eventLocation:
        ^use: '#/$defs/NRLocation'
        required: true

  NRLanguage:
    ^vocabulary:
      type: languages
      fields: [id, title]
    ^sample: ['cs', 'en', 'de', 'fr', 'it']
    label.cs: Jazyk
    label.en: Language

  NRLicense:
    ^vocabulary:
      type: licenses
      fields: [id, title]
    ^sample:
      - 'CC BY'
      - 'CC BY-SA'
      - 'CC BY-NC'
      - 'CC BY-ND'
      - 'CC BY-NC-SA'
      - 'CC BY-NC-ND'
    label.cs: Licence
    label.en: License

  NRAccessRights:
    ^vocabulary:
      type: accessRights
      fields: [id, title]
    ^sample: [open, embargoed, restricted, 'metadata only']
    label.cs: Přístupová práva
    label.en: Access rights

model:
  ^marshmallow:
    generate: false
    class: nr_common_metadata.services.schema.NRCommonMetadataSchema
  properties:
    metadata:
      properties:
        title:
          type: fulltext+keyword # Main (original) title of the object/work.
          required: true
          label.cs: Název
          label.en: Title

        additionalTitles[]:
          # Additional titles of the object/work such as subtitle, translatedTitle and alternativeTitle.
          uniqueItems[]: true
          properties:
            # TODO: zvazit, jestli preci jenom neprejit na pole extenzi langstringu, abychom byli datacite (a rdm)
            # primo kompatibilni
            title:
              type: i18nStr
              required: true
            titleType:
              type: keyword
              required: true
              enum: [translatedTitle, alternativeTitle, subtitle, other]

        creators[]:
          ^use: '#/$defs/NRAuthority'
          label.cs: Autoři
          label.en: Authors
          minItems[]: 1
          uniqueItems[]: true
          required[]: true
          properties:
            affiliations[]:
              ^vocabulary:
                name: creator_affiliations

        contributors[]:
          ^use: '#/$defs/NRAuthority'
          uniqueItems[]: true
          properties:
            role:
              ^use: '#/$defs/NRAuthorityRole'
            affiliations[]:
              ^vocabulary:
                name: contributor_affiliations

        resourceType:
          # Taxonomy driven typology of objects that's possible to store in the repository
          ^use: '#/$defs/NRResourceType'
          required: true

        dateAvailable:
          # The date the resource is publicly available in a repository.
          #
          # týká se dokumentu, nikoliv metadat!!!
          # stejně jako pro data, budou se přes něj řídit přístupy - embargo
          ^use: '#/$defs/NRDate'
          ^sample:
            faker: date
          label.cs: Datum zveřejnění
          label.en: Date available

        dateModified:
          # The date of the last update to the resource, not metadata
          #
          # týká se dokumentu/obsahu, nikoliv metadat!!!
          # neukazuje se ve vkládacím formuláři. jen při editaci záznamu!
          ^use: '#/$defs/NRDate'
          ^sample:
            faker: date
          label.cs: Datum změny zdroje
          label.en: Date modified

        subjects[]:
          # subject by vocabularies or free-form keywords created by author(s)
          ^use: '#/$defs/NRSubject'
          uniqueItems[]: true

        publishers[]:
          # volný zápis vydavatele
          type: fulltext
          uniqueItems[]: true
          ^sample:
            faker: company
          label.cs: Vydavatel
          label.en: Publisher

        subjectCategories[]:
          # FRASCATI oborové třídění - může sloužit jako podklad pro oborové filtrování
          ^use: '#/$defs/NRSubjectCategory'
          uniqueItems[]: true

        languages[]:
          # ISO 639-2 B in slug, ISO 639-2 T in alias, ISO 639-1 as Alpha2.
          ^use: '#/$defs/NRLanguage'
          minItems[]: 1
          required: true
          uniqueItems[]: true

        notes[]:
          # Free-form note for any comment that couldn't be inserted in any other fields.
          type: fulltext
          uniqueItems[]: true
          label.cs: Poznámka
          label.en: Note

        abstract:
          # i18nStr abstract description for record (may contain HTML).
          type: i18nStr
          label.cs: Abstrakt
          label.en: Abstract

        methods:
          # i18nStr methodology employed for the study or research.(may contain HTML)
          type: i18nStr
          label.cs: Metodologie
          label.en: Methods

        technicalInfo:
          # i18nStr detailed information that may be associated with
          # design, implementation, operation, use, and/or maintenance of a process
          # or system.(may contain HTML)
          type: i18nStr
          label.cs: Technické informace
          label.en: Technical information

        rights[]:
          # Any license or copyright information for this resource. Taxonomy field.
          ^use: '#/$defs/NRAccessRights'
          uniqueItems[]: true

        accessRights:
          # Taxonomy driven list of possible access to the document - open,
          # embargoed, restirected and metadata only access. Based on COAR
          # vocabulary - http://vocabularies.coar-repositories.org/documentation/access_rights/",
          ^use: '#/$defs/NRAccessRights'

        relatedItems[]:
          ^use: '#/$defs/NRRelatedItem'
          uniqueItems[]: true

        fundingReferences[]:
          ^use: '#/$defs/NRFundingReference'
          uniqueItems[]: true

        version:
          # verze obsahu, nikoliv záznamu. hodnota ve formuláři není editovatelná.
          type: keyword
          ^sample: ['1.0', '1.1', '2.0', '2.1', '2.2']
          label.cs: Verze zdroje
          label.en: Resource version

        geoLocations[]:
          ^use: '#/$defs/NRGeoLocation'
          uniqueItems[]: true

        accessibility:
          # textové vyjádření dostupnosti souborů, primárně pro harvestované zdroje.
          # nastavuje se pro každý zdroj zvlášť během konverze podle dostupnosti souborů
          # ve zdrojovém systému. ve vkládacím formuláři by bylo pouze pro restricted access
          type: i18nStr
          label.cs: Dostupnost zdroje
          label.en: Resource accessibility

        series[]:
          # edice; tématicky sdružuje podobné věci, nemusí se jednat o pravou edici,
          # ale tagování/grupování podobných záznamů
          uniqueItems[]: true

          properties:
            seriesTitle:
              type: keyword
              required: true
              # našeptávač již uložených hodnot
              ^sample: ['series A', 'series B', 'series C']
              label.cs: Název edice
              label.en: Series title
            seriesVolume:
              type: keyword
              ^sample: ['1', '2', '3', '4']
              label.cs: Svazek edice
              label.en: Series volume

        externalLocation:
          # externí umístění dokumentu (mimo repozitáře), formát URL
          properties:
            externalLocationURL:
              type: keyword
              format: URL
              required: true
              ^sample:
                faker: url
              label.cs: Externí umístění zdroje
              label.en: Resource external location
            externalLocationNote:
              type: fulltext
              label.cs: Poznámka
              label.en: Note

        originalRecord:
          # odkaz na původní záznam, zobrazovat koncovému uživateli v detailu záznamu
          # jako původní místo uložení. objevuje se jen u harvestu
          type: keyword
          format: URL
          ^sample:
            faker: url
          label.cs: Odkaz na původní záznam
          label.en: Original record URL

        objectIdentifiers[]:
          # Persistent identifier/s of object as ISBN, DOI, etc. + assigned by National Repository.
          ^use: '#/$defs/NRObjectPID'
          uniqueItems[]: true

        systemIdentifiers[]:
          ^use: '#/$defs/NRSystemIdentifier'

        events[]:
          ^use: '#/$defs/NREvent'
