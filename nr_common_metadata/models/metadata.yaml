# Copyright (c) 2022 CESNET
#
# This software is released under the MIT License.
# https://opensource.org/licenses/MIT

$defs:
  NRAuthorityIdentifier:
    oarepo:ui:
      default:
        component: icon
        dataField: scheme
        iconSet:
          DOI: icons/identifier/doi.gif
          scopusID: icons/identifier/scopus.svg
          orcid: icons/identifier/orcid.png
    properties:
      identifier:
        type: keyword
        required: true
        oarepo:sample:
          faker: isbn13
      scheme:
        type: keyword
        required: true
        enum:
          [
            orcid,
            scopusID,
            researcherID,
            czenasAutID,
            vedidk,
            institutionalID,
            ISNI,
            ROR,
            ICO,
            DOI,
          ]
  NRAuthority:
    properties:
      fullName:
        # TODO: moznost duplicity - pridat pole jmeno a prijmeni pro nove zaznamy + do ui generovani fullName podle pravidel
        type: keyword
        required: true
        oarepo:sample:
          faker: name
        oarepo:ui:
          component: span
      nameType:
        type: keyword
        enum: [Organizational, Personal]
        oarepo:sample: [Organizational, Personal]
      authorityIdentifiers[]:
        oarepo:use: '#/$defs/NRAuthorityIdentifier'
        uniqueItems[]: true
        oarepo:ui[]:
          default:
            component: list
            horizontal: true
            separator:
              component: separator
            item:
              #TODO: this reference should be automagically done by model builder
              oarepo:use: '#/$defs/NRAuthorityIdentifier/oarepo:ui/default'
      affiliations[]:
        $description: taxonomie institutions
        oarepo:sample:
          faker: company
        oarepo:vocabulary:
          type: affiliation
          fields: [id, title]
        uniqueItems[]: true
  NRObjectPID:
    $description: Persistent identifier of object

    properties:
      identifier:
        type: keyword
        required: true
        oarepo:sample:
          faker: isbn13
        oarepo:ui:
          default:
            component: span
      scheme:
        type: keyword
        required: true
        oarepo:ui:
          default:
            component: icon
            dataField: scheme
            iconSet:
              DOI: icons/identifier/doi.gif
        enum: [DOI, Handle, ISBN, ISSN, RIV]

  NRDateOrRange:
    type: keyword
    # TODO: jak validovat a interpretovat tento format (a jak ho pak spravne facetovat)
    format: 'year | yearmonth | date | datetime | year-range | yearmonth-range | date-range | datetime-range'
    oarepo:ui:
      default:
        component: span

  NRDate:
    type: keyword
    oarepo:ui:
      default:
        component: span
    # format: [ year | yearmonth | date | datetime ]

  NRLocation:
    properties:
      place:
        type: keyword
        required: true
      country:
        oarepo:use: '#/$defs/NRCountry'

  NRCountry:
    oarepo:vocabulary:
      type: country
      fields: [id, title]

  NRLongitude:
    type: number
    minimum: -180
    maximum: 180

  NRLatitude:
    type: number
    minimum: -90
    maximum: 90

  NRAuthorityRole:
    oarepo:ui:
      default:
        component: span
    oarepo:vocabulary:
      type: role
      fields: [id, title]

  NRRelatedItem:
    description: linkdata, propojení přidružených dokumentů a datasetů.

    properties:
      itemTitle:
        description: název propojeného dokumentu
        type: fulltext
        required: true
        oarepo:ui:
          default:
            component: span

      itemCreators[]:
        oarepo:use: '#/$defs/NRAuthority'
        uniqueItems[]: true

      itemContributors[]:
        oarepo:use: '#/$defs/NRAuthority'
        properties:
          role:
            oarepo:use: '#/$defs/NRAuthorityRole'
        uniqueItems[]: true

      itemPIDs[]:
        oarepo:use: '#/$defs/ObjectPID'
        uniqueItems[]: true

      itemURL:
        type: keyword
        format: URL
        oarepo:ui:
          default:
            component: link
        oarepo:sample:
          faker: url

      itemYear:
        type: integer
        oarepo:ui:
          default:
            component: span

      itemVolume:
        type: keyword
        oarepo:ui:
          default:
            component: span

      itemIssue:
        type: keyword
        oarepo:ui:
          default:
            component: span

      itemStartPage:
        type: keyword
        oarepo:ui:
          default:
            component: span

      itemEndPage:
        type: keyword
        oarepo:ui:
          default:
            component: span

      itemPublisher:
        type: keyword
        oarepo:ui:
          default:
            component: span

      itemRelationType:
        description: typ vztahu k původnímu popisovanému dok.
        oarepo:vocabulary:
          type: itemRelationType
          fields: [id, title]

      itemResourceType:
        oarepo:use: '#/$defs/NRResourceType'

  NRResourceType:
    oarepo:vocabulary:
      type: resourceType
      fields: [id, title]

  NRFundingReference:
    $description: informace o přidruženém projektu
    $comment: >
      MIGRACE NUŠL - protože v datech NUŠL hrozný stav v polích pro poskytovatele.
      u českých projektů na základě prvních dvou znaků v řetězci s identifikátorem
      projektu lze přiřadit poskytovatele.
    oarepo:ui:
      default:
        component: divided-row
        separator:
          component: separator
        items:
          - component: span
            dataField: projectID
          - component: span
            dataField: projectName
    properties:
      projectID:
        type: keyword
        required: true
      projectName:
        type: fulltext
      fundingProgram:
        type: fulltext
      funder:
        oarepo:use: '#/$defs/NRFunder'
        #required: true

  NRFunder:
    oarepo:vocabulary:
      type: funders
      fields: [id, title]

  NRGeoLocation:
    properties:
      geoLocationPlace:
        description: Free description of the location; ie. Atlantic Ocean
        type: keyword
        required: true
      geoLocationPoint:
        properties:
          pointLongitude:
            oarepo:use: '#/$defs/NRLongitude'
            required: true
          pointLatitude:
            oarepo:use: '#/$defs/NRLatitude'
            required: true

  NRSystemIdentifier:
    $description: >
      systémové identifikátory a trvalé adresy pořízené skrze OAI, případně importy/migrace",
    $comment: >
      možná bude sekce OAI fungovat jinak,takže možná bude potřeba to upravit. Ale tohle jsou údaje,
      které by se měli ukládat přímo v záznamu; nusl = PURL
    properties:
      identifier:
        type: keyword
        required: true
      scheme:
        type: keyword
        enum: [nusl, nuslOAI, originalRecordOAI, catalogueSysNo, nrOAI]
        required: true

  NREvent:
    properties:
      eventNameOriginal:
        $description: volný zápis celého názvu akce
        type: fulltext
        required: true

      eventNameAlternate[]:
        $description: zkrácená forma názvu akce nebo překladu. měla by fungovat jako alias pro vyhledávání
        type: fulltext

      eventDate:
        description: rozsah konání akce/konference -  date or range.
        oarepo:use: '#/$defs/DateOrRange'
        required: true

      eventLocation:
        oarepo:use: '#/$defs/NRLocation'
        required: true
